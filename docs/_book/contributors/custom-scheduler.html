<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Building a Custom Scheduler | Heron</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-anchors/plugin.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    

        
    
    
    <link rel="next" href="../operators/index.html" />
    
    
    <link rel="prev" href="../contributors/index.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="2.1" data-basepath=".." data-revision="Wed Dec 23 2015 14:44:27 GMT-0800 (PST)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="concepts/index.html">
            
                
                    <a href="../concepts/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Concepts
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="concepts/architecture.html">
            
                
                    <a href="../concepts/architecture.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        The Architecture of Heron
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="concepts/topologies.html">
            
                
                    <a href="../concepts/topologies.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Heron Topologies
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="contributors/index.html">
            
                
                    <a href="../contributors/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Contributors
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="2.1" data-path="contributors/custom-scheduler.html">
            
                
                    <a href="../contributors/custom-scheduler.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Building a Custom Scheduler
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="operators/index.html">
            
                
                    <a href="../operators/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Operators
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="operators/deployment/index.html">
            
                
                    <a href="../operators/deployment/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Deployment
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="operators/deployment/zookeeper.html">
            
                
                    <a href="../operators/deployment/zookeeper.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                        Setting Up ZooKeeper
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="operators/deployment/aurora.html">
            
                
                    <a href="../operators/deployment/aurora.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                        Aurora
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="operators/deployment/mesos.html">
            
                
                    <a href="../operators/deployment/mesos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.3.</b>
                        
                        Mesos
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="operators/deployment/local.html">
            
                
                    <a href="../operators/deployment/local.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.4.</b>
                        
                        Local scheduler
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="operators/compiling.html">
            
                
                    <a href="../operators/compiling.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Compiling Heron
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Heron</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="implementing-a-custom-scheduler"><a name="implementing-a-custom-scheduler" class="plugin-anchor" href="#implementing-a-custom-scheduler"><span class="fa fa-link"></span></a>Implementing a Custom Scheduler</h1>
<p>To run a Heron cluster, you&apos;ll need to set up a scheduler that is responsible
for cluster management. Heron supports three schedulers out of the box:</p>
<ul>
<li><a href="../operators/deployment/mesos.html">Mesos</a></li>
<li><a href="../operators/deployment/aurora.html">Aurora</a></li>
<li><a href="../operators/deployment/local.html">Local scheduler</a></li>
</ul>
<p>If you&apos;d like to run Heron on a not-yet-supported system, such as
<a href="https://hadoop.apache.org/docs/current/hadoop-yarn/hadoop-yarn-site/YARN.html" target="_blank">YARN</a>
or <a href="https://aws.amazon.com/ecs/" target="_blank">Amazon ECS</a>, you can create your own scheduler
using Heron&apos;s <a href="../api/scheduler/index.html">scheduler API</a>, as detailed in the
sections below.</p>
<p>Java is currently the only supported language for custom schedulers. This may
change in the future.</p>
<h2 id="java-setup"><a name="java-setup" class="plugin-anchor" href="#java-setup"><span class="fa fa-link"></span></a>Java Setup</h2>
<p>In order to create a custom scheduler, you need to import the <code>scheduler</code>
library into your project.</p>
<h4 id="maven"><a name="maven" class="plugin-anchor" href="#maven"><span class="fa fa-link"></span></a>Maven</h4>
<pre><code class="lang-xml"><span class="hljs-tag">&lt;<span class="hljs-title">dependency</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">groupId</span>&gt;</span>com.twitter.heron<span class="hljs-tag">&lt;/<span class="hljs-title">groupId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">artifactId</span>&gt;</span>scheduler<span class="hljs-tag">&lt;/<span class="hljs-title">artifactId</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">version</span>&gt;</span>0.1.0<span class="hljs-tag">&lt;/<span class="hljs-title">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">dependency</span>&gt;</span></code></pre>

<h4 id="gradle"><a name="gradle" class="plugin-anchor" href="#gradle"><span class="fa fa-link"></span></a>Gradle</h4>
<pre><code class="lang-groovy">dependencies {
  compile <span class="hljs-string">group:</span> <span class="hljs-string">&quot;com.twitter.heron&quot;</span>, <span class="hljs-string">name:</span> <span class="hljs-string">&quot;scheduler&quot;</span>, <span class="hljs-string">version:</span> <span class="hljs-string">&quot;0.1.0&quot;</span>
}</code></pre>

<h2 id="interfaces"><a name="interfaces" class="plugin-anchor" href="#interfaces"><span class="fa fa-link"></span></a>Interfaces</h2>
<p>Creating a custom scheduler involves implementing each of the following Java
interfaces:</p>
<table>
<thead>
<tr>
<th style="text-align:left">Interface</th>
<th style="text-align:left">Role</th>
<th style="text-align:left">Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/api/IConfigLoader.html"><code>IConfigLoader</code></a></td>
<td style="text-align:left">Parsing and loading of configuration for the scheduler</td>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/aurora/AuroraConfigLoader.html">Aurora</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/mesos/MesosConfigLoader.html">Mesos</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/local/LocalConfigLoader.html">local</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/api/ILauncher.html"><code>ILauncher</code></a></td>
<td style="text-align:left">Defines how the scheduler is launched</td>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/aurora/AuroraLauncher.html">Aurora</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/mesos/MesosLauncher.html">Mesos</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/local/LocalLauncher.html">local</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/api/IRuntimeManager.html"><code>IRuntimeManager</code></a></td>
<td style="text-align:left">Handles runtime tasks such as activating topologies, killing topologies, etc.</td>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/aurora/AuroraTopologyRuntimeManager.html">Aurora</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/mesos/MesosTopologyRuntimeManager.html">Mesos</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/local/LocalTopologyRuntimeManager.html">local</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/api/IScheduler.html"><code>IScheduler</code></a></td>
<td style="text-align:left">Defines the scheduler object used to construct topologies</td>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/mesos/MesosScheduler.html">Mesos</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/local/LocalScheduler.html">local</a></td>
</tr>
<tr>
<td style="text-align:left"><a href="../api/scheduler/com/twitter/heron/scheduler/api/IUploader.html"><code>IUploader</code></a></td>
<td style="text-align:left">Uploads the topology to a shared location that must be accessible to the runtime environment of the topology</td>
<td style="text-align:left"><a href="">Aurora</a>, <a href="">Mesos</a>, <a href="../api/scheduler/com/twitter/heron/scheduler/local/LocalUploader.html">local</a></td>
</tr>
</tbody>
</table>
<p>Your implementation of those interfaces will need to be on Heron&apos;s
<a href="https://docs.oracle.com/javase/tutorial/essential/environment/paths.html" target="_blank">classpath</a>
when you <a href="../operators/compiling.html">compile Heron</a>.</p>
<h2 id="loading-configuration"><a name="loading-configuration" class="plugin-anchor" href="#loading-configuration"><span class="fa fa-link"></span></a>Loading Configuration</h2>
<p>You can set up a configuration loader for a custom scheduler by implementing the
<a href="../api/scheduler/com/twitter/heron/scheduler/api/IConfig.html"><code>IConfig</code></a>
interface. You can use this interface to load configuration from any source
you&apos;d like, e.g. YAML files, JSON files, or a web service.</p>
<p>If you&apos;d like to load configuration from files using the same syntax as Heron&apos;s
default configuration files for the Aurora, Mesos, and local schedulers (in
<code>heron/cli2/src/python</code>), you can implement the
<a href="../api/scheduler/com/twitter/heron/scheduler/util/DefaultConfigLoader.html"><code>DefaultConfigLoader</code></a>
interface.</p>
<h2 id="configurable-parameters"><a name="configurable-parameters" class="plugin-anchor" href="#configurable-parameters"><span class="fa fa-link"></span></a>Configurable Parameters</h2>
<p>At the very least, your configuration loader will need to be able to load the
class names (as strings) for your implementations of the components listed
above, as you can see from the interface definition for
<a href="../api/scheduler/com/twitter/heron/scheduler/api/IConfigLoader.html"><code>IConfigLoader</code></a>.</p>
<h2 id="trying-out-your-scheduler"><a name="trying-out-your-scheduler" class="plugin-anchor" href="#trying-out-your-scheduler"><span class="fa fa-link"></span></a>Trying Out Your Scheduler</h2>
<p>Once you&apos;ve implemented a custom configuration loader, you&apos;ll need to specify
your loader by class using the <code>--config-loader</code> flag. If your loader relies on
a configuration file, specify the path of that file using the <code>--config-file</code>
flag. Here&apos;s an example <a href="../operators/heron-cli.html#submitting-a-topology">topology
submission</a> command:</p>
<pre><code class="lang-bash">$ heron-cli submit <span class="hljs-string">&quot;topology.debug:true&quot;</span> \
    /path/to/topology/my-topology.jar \
    biz.acme.topologies.MyTopology \
    --config-file=/path/to/config/my_scheduler.conf \
    --config-loader=biz.acme.config.MyConfigLoader
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../contributors/index.html" class="navigation navigation-prev " aria-label="Previous page: Contributors"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../operators/index.html" class="navigation navigation-next " aria-label="Next page: Operators"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
